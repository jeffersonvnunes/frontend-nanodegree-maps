var Point=function(t){var e=this;e.title=ko.observable(t.title),e.type=ko.observable(t.type),e.lat=ko.observable(t.lat),e.lng=ko.observable(t.lng),e.clicked=ko.observable(!1),e.tips=t.tips,e.id=t.id,e.position=function(){return{lat:e.lat(),lng:e.lng()}}};
var ViewModel=function(){var e,i=this;i.pointList=ko.observableArray([]),i.hasItem=ko.observable(!1),i.foursquareErrorMessage=ko.observable(""),i.googleErrorMessage=ko.observable(""),i.initPointlist=function(t){if(i.map){var o;(e=new google.maps.InfoWindow).addListener("closeclick",function(){e.marker=null}),t.forEach(function(t){(o=new Point(t)).show=!0,o.marker=new google.maps.Marker({position:o.position(),title:o.title(),animation:google.maps.Animation.DROP}),o.highlightMarker=(r=o,function(){if(!i.clickedPoint||i.clickedPoint.id!==r.id){i.clickedPoint&&(i.clickedPoint.clicked(!1),i.clickedPoint.marker.setIcon(null),i.clickedPoint.marker.setAnimation(null)),r.clicked(!0),r.marker.setIcon("img/green-dot.png"),r.marker.setAnimation(google.maps.Animation.BOUNCE),i.clickedPoint=r,e.marker=r.marker;for(var t='<div style="max-height: 100vh;"> <h3>'+r.marker.title+'</h3> <h4>Tips</h4> <ul class="list-unstyled components">',o=0;o<r.tips.length;o++)t=t+"<li>"+r.tips[o].text+"</li>";t+="</ui></div>",e.setContent(t),e.open(i.map,r.marker)}});var r;o.marker.addListener("click",o.highlightMarker),i.pointList.push(o)})}},i.currentFilter=ko.observable();var t=ko.observableArray([]);i.activePointList=ko.computed(function(){var o=i.pointList(),r=i.currentFilter();void 0!==r&&(r.length>2||0===r.length)&&(i.clickedPoint&&(i.clickedPoint.clicked(!1),i.clickedPoint.marker.setIcon(null),i.clickedPoint.marker.setAnimation(null),e.marker=null),o.forEach(function(e){e.show=0===r.length||e.title().toUpperCase().search(r.toUpperCase())>=0})),t.removeAll();for(var n=0;n<o.length;n++)o[n].marker.setMap(null),o[n].show&&(o[n].marker.setMap(i.map),t.push(o[n]));return i.hasItem(t().length>0),t()},i)};